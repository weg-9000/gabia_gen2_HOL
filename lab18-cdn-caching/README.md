# Lab 20: CDN 구성

## 학습 목표

- CDN 서비스 생성 및 타입(Local/Global) 선택
- 원본 서버 연동 및 캐싱 설정
- 캐시 퍼지 및 캐싱 제외 설정
- 사용자 도메인 및 SSL 인증서 연결

**소요 시간**: 30분
**난이도**: 중급

---

## 실습 단계

### 1. CDN 생성

```
콘솔 > 네트워크 > CDN > 생성

```

[입력 정보]

| 항목 | 값 |
| --- | --- |
| CDN 타입 | Local CDN |
| 원본 서버 경로 | http://[Origin서버IP 또는 도메인] |
| TTL | 86400 (기본값) |
| 사용자 도메인 | 사용 안 함 |
| 이름 | lab-cdn |
| 설명 | Lab 실습용 CDN |

생성 완료 시:

- 캐시 서버 도메인 자동 발급 (예: [abc123.kinxzone.com](http://abc123.kinxzone.com/))
- HTTP/HTTPS 두 가지 형태로 제공

### 2. CDN 정보 확인

```
콘솔 > 네트워크 > CDN > lab-cdn 선택

```

확인 항목:

- 기본 정보: CDN ID, 이름, 운영 상태, CDN 타입, 생성일시
- 캐시 서버 관리: 캐시 서버 경로, 사용자 도메인, SSL 인증서, TTL
- 원본 서버 관리: 원본 서버 경로(URL)

### 3. 캐싱 설정 변경

```
콘솔 > 네트워크 > CDN > lab-cdn > 캐시 서버 관리

```

TTL 변경:

| 항목 | 값 |
| --- | --- |
| TTL | 3600 (1시간) |
- 캐시 서버 운영 상태와 무관하게 변경 가능

### 4. 캐싱 제외 설정

```
콘솔 > 네트워크 > CDN > lab-cdn > 캐시 서버 관리 > 캐싱 제외 설정

```

[입력 정보]

| 항목 | 값 |
| --- | --- |
| 사용 여부 | 사용 |
| 제외 확장자 | php, asp |
| 제외 경로 | /api/* |

주의사항:

- 전체 경로(/*)는 캐싱 예외 대상으로 설정 불가
- 와일드카드(*)로 특정 경로 내 모든 파일 제외 가능

### 5. 캐시 퍼지 실행

```
콘솔 > 네트워크 > CDN > lab-cdn > 캐시 서버 관리 > 캐시 서버 퍼지

```

[입력 정보]

| 항목 | 값 |
| --- | --- |
| 퍼지 경로 | /images/* |
- 원본 서버에 대해 퍼지할 디렉토리 경로 입력

### 6. CDN 접속 테스트

```bash
# 캐시 서버 도메인으로 접속 테스트
curl -I http://[캐시서버도메인]/

# HTTPS 접속 테스트
curl -I https://[캐시서버도메인]/

# 응답 헤더 확인
curl -I http://[캐시서버도메인]/css/style.css

```

### 7. 사용자 도메인 설정 (선택)

```
콘솔 > 네트워크 > CDN > lab-cdn > 캐시 서버 관리 > 사용자 도메인 설정

```

[입력 정보]

| 항목 | 값 |
| --- | --- |
| 사용 여부 | 사용 |
| 도메인 | [cdn.example.com](http://cdn.example.com/) |
| SSL 인증서 | [등록된 인증서 선택] 또는 선택 안 함 |

사전 작업:

- DNS에서 [cdn.example.com](http://cdn.example.com/) → 캐시 서버 도메인 CNAME 설정
- SSL 사용 시 콘솔에 SSL 인증서 사전 등록 필요

### 8. CDN 삭제

```
콘솔 > 네트워크 > CDN > lab-cdn > 삭제

```

---

## 트러블슈팅

| 문제 | 원인 | 해결 |
| --- | --- | --- |
| CDN 생성 실패 | 이름 중복 | 프로젝트 내 고유한 이름 사용 |
| 캐시 미적용 | TTL 0 또는 캐싱 제외 설정 | TTL 값 확인, 캐싱 제외 경로 확인 |
| 원본 서버 접속 불가 | Origin URL 오류 | 원본 서버 URL 및 접근성 확인 |
| 전체 캐싱 제외 불가 | 정책 제한 | /* 대신 특정 경로별 설정 |
| 사용자 도메인 접속 불가 | DNS 미설정 | CNAME 레코드 설정 확인 |
| HTTPS 접속 오류 | SSL 인증서 미등록 | 콘솔에서 SSL 인증서 등록 후 연결 |

---

## 완료 체크리스트

```
[ ] CDN 생성 완료 (타입: Local CDN)
[ ] 캐시 서버 도메인 발급 확인
[ ] TTL 설정 변경
[ ] 캐싱 제외 설정 (확장자/경로)
[ ] 캐시 퍼지 실행
[ ] CDN 접속 테스트 (HTTP/HTTPS)
[ ] 사용자 도메인 설정 (선택)
[ ] CDN 삭제

```

---

**다음 Lab**: Lab 21: 계정 관리

---

## 참고: CDN 타입 비교

| 항목 | Local CDN | Global CDN |
| --- | --- | --- |
| Edge 서버 범위 | 국내 | 글로벌 |
| 주요 사용 대상 | 국내 사용자 대상 서비스 | 해외 사용자 포함 서비스 |
